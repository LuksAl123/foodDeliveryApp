"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[6773],{6773:(O,g,l)=>{l.r(g),l.d(g,{EditAddressPageModule:()=>w});var u=l(4755),c=l(5030),a=l(6794),m=l(4517),p=l(5861),_=l(7123),e=l(2223),v=l(7172),y=l(7020),f=l(9514),A=l(2875);const M=["map"];let b=(()=>{class i{constructor(t,n,o){this.maps=t,this.renderer=n,this.locationService=o,this.update=!1,this.center={lat:28.649944693035188,lng:77.23961776224988},this.location=new e.vpe}ngOnInit(){}ngAfterViewInit(){var t=this;return(0,p.Z)(function*(){yield t.initMap(),t.mapChange=t.maps.markerChange.subscribe(function(){var n=(0,p.Z)(function*(o){if(o?.lat){console.log("loc: ",o),console.log("maps: ",t.googleMaps);const d=new t.googleMaps.LatLng(o.lat,o.lng);t.map.panTo(d),t.marker.setMap(null),yield t.addMarker(d)}});return function(o){return n.apply(this,arguments)}}())})()}initMap(){var t=this;return(0,p.Z)(function*(){try{if(t.update)yield t.loadMap();else{const n=yield t.locationService.getCurrentLocation();t.center={lat:n.coords.latitude,lng:n.coords.longitude},yield t.loadMap(),t.getAddress(t.center.lat,t.center.lng)}}catch(n){console.log(n),t.center={lat:28.649944693035188,lng:77.23961776224988},console.log(t.center),t.loadMap(),t.getAddress(t.center.lat,t.center.lng)}})()}loadMap(){var t=this;return(0,p.Z)(function*(){try{let o=yield t.maps.loadGoogleMaps();t.googleMaps=o;const r=[{featureType:"all",elementType:"all",stylers:[{saturation:-100}]}],d=t.mapElementRef.nativeElement,h=new o.LatLng(t.center.lat,t.center.lng);t.map=new o.Map(d,{center:h,zoom:15,scaleControl:!1,streetViewControl:!1,zoomControl:!1,overviewMapControl:!1,mapTypeControl:!1,mapTypeControlOptions:{mapTypeIds:[o.MapTypeId.ROADMAP,"SwiggyClone"]}});var n=new o.StyledMapType(r,{name:"Grayscale"});t.map.mapTypes.set("SwiggyClone",n),t.map.setMapTypeId("SwiggyClone"),t.renderer.addClass(d,"visible"),t.addMarker(h)}catch(o){console.log(o)}})()}addMarker(t){let n=this.googleMaps;const o={url:"assets/icons/location-pin.png",scaledSize:new n.Size(50,50)};this.marker=new n.Marker({position:t,map:this.map,icon:o,draggable:!0,animation:n.Animation.DROP}),this.mapListener=this.googleMaps.event.addListener(this.marker,"dragend",()=>{console.log("markerchange"),this.getAddress(this.marker.position.lat(),this.marker.position.lng())})}getAddress(t,n){var o=this;return(0,p.Z)(function*(){try{const r=yield o.maps.getAddress(t,n);console.log(r);const d={title:r.address_components[0].short_name,address:r.formatted_address,lat:t,lng:n};console.log(d),o.location.emit(d)}catch(r){console.log(r)}})()}ngOnDestroy(){this.mapListener&&this.googleMaps.event.removeListener(this.mapListener),this.mapChange&&this.mapChange.unsubscribe()}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(f.t),e.Y36(e.Qsj),e.Y36(A.a))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-map"]],viewQuery:function(t,n){if(1&t&&e.Gf(M,7),2&t){let o;e.iGM(o=e.CRH())&&(n.mapElementRef=o.first)}},inputs:{update:"update",center:"center"},outputs:{location:"location"},decls:2,vars:0,consts:[[1,"map"],["map",""]],template:function(t,n){1&t&&e._UZ(0,"div",0,1)},styles:[".map[_ngcontent-%COMP%]{position:absolute;height:30vh;width:100%;background-color:transparent;opacity:0;transition:opacity .15s ease-in}.map.visible[_ngcontent-%COMP%]{opacity:1}"]}),i})();function Z(i,s){1&i&&(e.TgZ(0,"div",7),e._UZ(1,"ion-spinner",8),e.qZA())}function C(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"div",9)(1,"app-map",10),e.NdJ("location",function(o){e.CHM(t);const r=e.oxw();return e.KtG(r.fetchLocation(o))}),e.qZA()()}if(2&i){const t=e.oxw();e.xp6(1),e.Q6J("center",t.center)("update",t.update)}}function x(i,s){1&i&&e._UZ(0,"ion-icon",26)}function P(i,s){1&i&&e._UZ(0,"ion-icon",26)}function T(i,s){1&i&&e._UZ(0,"ion-icon",26)}function k(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"ion-button",27),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(2);return e.KtG(o.onSubmit())}),e._uU(1,"SAVE & PROCEED "),e.qZA()}if(2&i){const t=e.oxw(2);e.Q6J("disabled",!(null!=t.form&&t.form.valid))}}function E(i,s){1&i&&(e.TgZ(0,"ion-button",28),e._UZ(1,"ion-spinner",29),e.qZA())}function S(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"form",11)(1,"ion-list")(2,"ion-item",12),e._UZ(3,"ion-icon",13),e.TgZ(4,"ion-label"),e._uU(5),e.qZA(),e.TgZ(6,"ion-button",14),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.searchLocation())}),e.TgZ(7,"span"),e._uU(8,"CHANGE"),e.qZA()()(),e.TgZ(9,"ion-row",15)(10,"ion-note",16),e._uU(11),e.qZA()(),e.TgZ(12,"ion-item-group",17)(13,"ion-item")(14,"ion-label",18)(15,"span"),e._uU(16,"HOUSE / FLAT / BLOCK NO."),e.qZA()(),e._UZ(17,"ion-input",19),e.YNc(18,x,1,0,"ion-icon",20),e.qZA(),e.TgZ(19,"ion-item")(20,"ion-label",18)(21,"span"),e._uU(22,"LANDMARK"),e.qZA()(),e._UZ(23,"ion-input",21),e.YNc(24,P,1,0,"ion-icon",20),e.qZA(),e.TgZ(25,"ion-item")(26,"ion-label",18)(27,"span"),e._uU(28,"SAVE AS"),e.qZA()(),e._UZ(29,"ion-input",22),e.YNc(30,T,1,0,"ion-icon",20),e.qZA()()(),e.TgZ(31,"div",23),e.YNc(32,k,2,1,"ion-button",24),e.YNc(33,E,2,0,"ion-button",25),e.qZA()()}if(2&i){const t=e.oxw();e.Q6J("formGroup",t.form),e.xp6(5),e.Oqu(null==t.location?null:t.location.title),e.xp6(6),e.hij(" ",null==t.location?null:t.location.address," "),e.xp6(7),e.Q6J("ngIf",t.form.get("house").valid),e.xp6(6),e.Q6J("ngIf",t.form.get("landmark").valid),e.xp6(6),e.Q6J("ngIf",t.form.get("title").valid),e.xp6(2),e.Q6J("ngIf",!t.isSubmitted),e.xp6(1),e.Q6J("ngIf",t.isSubmitted)}}const L=[{path:"",component:(()=>{class i{constructor(t,n,o,r,d){this.navCtrl=t,this.addressService=n,this.global=o,this.maps=r,this.route=d,this.isSubmitted=!1,this.location={},this.isLoading=!1,this.check=!1}ngOnInit(){this.checkForUpdate()}checkForUpdate(){var t=this;return(0,p.Z)(function*(){t.isLoading=!0,t.location.title="Locating...",t.isLocationFetched=!1;const n=t.route.snapshot.queryParams;if(console.log("data: ",n),n?.data){const o=JSON.parse(n.data);o?.lat&&(t.center={lat:o.lat,lng:o.lng},t.update=!0,t.location.lat=t.center.lat,t.location.lng=t.center.lng,t.location.address=o.address,t.location.title=o.title,o?.from||(t.id=o.id)),o.from&&(t.from=o.from),yield t.initForm(o),t.toggleFetched()}else t.update=!1,t.initForm()})()}initForm(t){let n={title:null,house:null,landmark:null};t&&(n={title:t.title,house:t.house,landmark:t.landmark}),this.formData(n)}formData(t){this.form=new c.cw({title:new c.NI(t.title,{validators:[c.kI.required]}),house:new c.NI(t.house,{validators:[c.kI.required]}),landmark:new c.NI(t.landmark,{validators:[c.kI.required]})}),this.isLoading=!1}fetchLocation(t){this.location=t,console.log("location: ",this.location),this.isLocationFetched=!0}toggleFetched(){this.isLocationFetched=!this.isLocationFetched}toggleSubmit(){this.isSubmitted=!this.isSubmitted}onSubmit(){var t=this;return(0,p.Z)(function*(){try{if(t.toggleSubmit(),console.log(t.form),!t.form.valid||!t.isLocationFetched)return void t.toggleSubmit();const n={title:t.form.value.title,landmark:t.form.value.landmark,house:t.form.value.house,address:t.location.address,lat:t.location.lat,lng:t.location.lng};console.log("address: ",n),t.id?yield t.addressService.updateAddress(t.id,n):yield t.addressService.addAddress(n),t.check=!0,t.navCtrl.back(),t.toggleSubmit()}catch(n){console.log(n),t.isSubmitted=!1,t.global.errorToast()}})()}searchLocation(){var t=this;return(0,p.Z)(function*(){try{const n={component:_.t,cssClass:"address-modal",swipeToClose:!0},o=yield t.global.createModal(n);if(console.log("location: ",o),o){t.location=o;const r={lat:o.lat,lng:o.lng};t.update=!0,t.maps.changeMarkerInMap(r)}}catch(n){console.log(n)}})()}ionViewDidLeave(){console.log("ionViewDidLeave EditAddressPage"),"home"==this.from&&!this.check&&this.addressService.changeAddress({})}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(a.SH),e.Y36(v.D),e.Y36(y.U),e.Y36(f.t),e.Y36(m.gz))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-edit-address"]],decls:7,vars:3,consts:[["fullscreen","true"],["slot","fixed"],["slot","start","mode","md"],["defaultHref","/tabs/address"],["class","ion-text-center alignSpinner",4,"ngIf"],["class","map",4,"ngIf"],[3,"formGroup",4,"ngIf"],[1,"ion-text-center","alignSpinner"],["color","primary"],[1,"map"],[3,"center","update","location"],[3,"formGroup"],["lines","none"],["name","location-outline","color","dark","slot","start"],["slot","end","size","small","color","light",3,"click"],[1,"ion-padding-horizontal","ion-text-justify"],[1,"ion-text-wrap","ion-padding-horizontal"],[1,"ion-padding"],["color","medium","position","floating"],["type","text","autocomplete","","autocorrect","","formControlName","house"],["name","checkmark-outline","slot","end","color","primary",4,"ngIf"],["type","text","autocomplete","","autocorrect","","formControlName","landmark"],["type","text","autocomplete","","autocorrect","","formControlName","title"],[1,"ion-padding-horizontal"],["expand","block","type","submit","color","primary",3,"disabled","click",4,"ngIf"],["expand","block","color","primary",4,"ngIf"],["name","checkmark-outline","slot","end","color","primary"],["expand","block","type","submit","color","primary",3,"disabled","click"],["expand","block","color","primary"],["name","crescent"]],template:function(t,n){1&t&&(e.TgZ(0,"ion-content",0)(1,"ion-toolbar",1)(2,"ion-buttons",2),e._UZ(3,"ion-back-button",3),e.qZA()(),e.YNc(4,Z,2,0,"div",4),e.YNc(5,C,2,2,"div",5),e.YNc(6,S,34,8,"form",6),e.qZA()),2&t&&(e.xp6(4),e.Q6J("ngIf",n.isLoading),e.xp6(1),e.Q6J("ngIf",!n.isLoading),e.xp6(1),e.Q6J("ngIf",!n.isLoading))},dependencies:[u.O5,c._Y,c.JJ,c.JL,c.sg,c.u,a.oU,a.YG,a.Sm,a.W2,a.gu,a.pK,a.Ie,a.Ub,a.Q$,a.q_,a.uN,a.Nd,a.PQ,a.sr,a.j9,a.cs,b],styles:["ion-toolbar[_ngcontent-%COMP%]{--background: transparent;--ion-color-base: transparent !important}.map[_ngcontent-%COMP%]{height:30vh}ion-item[_ngcontent-%COMP%]{align-items:center}ion-item[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:var(--ion-color-primary)}ion-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:.8rem}"]}),i})()}];let I=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[m.Bz.forChild(L),m.Bz]}),i})();var U=l(5642);let w=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[u.ez,c.UX,a.Pc,I,U.K]}),i})()}}]);