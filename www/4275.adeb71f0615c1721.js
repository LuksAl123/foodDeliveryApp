"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[4275,7172],{3033:(w,R,r)=>{r.d(R,{k:()=>h});class h{constructor(a,x,y,U,C,b,Z,q){this.uid=a,this.title=x,this.address=y,this.landmark=U,this.house=C,this.lat=b,this.lng=Z,this.id=q}}},3411:(w,R,r)=>{r.r(R),r.d(R,{AddRestaurantPageModule:()=>$});var h=r(4755),m=r(5030),a=r(6794),x=r(4517),y=r(5861),U=r(8746),C=r(7123),b=r(9260);class Z{constructor(l,n,i,d,c,g,v,I,P,T,J,S,D,V,ee,te,ne,ie,se,oe,ae){this.uid=l,this.cover=n,this.name=i,this.short_name=d,this.cuisines=c,this.rating=g,this.delivery_time=v,this.price=I,this.phone=P,this.email=T,this.isClose=J,this.description=S,this.openTime=D,this.closeTime=V,this.city=ee,this.address=te,this.status=ne,this.totalRating=ie,this.coordinates=se,this.g=oe,this.distance=ae}}r(5878);var e=r(2223),s=r(1228),o=r(9097),u=r(2158),p=r(7020);function _(t,l){1&t&&(e.TgZ(0,"ion-text",51)(1,"p",52),e._uU(2,"* Please enter your name"),e.qZA()())}function f(t,l){1&t&&(e.TgZ(0,"ion-text",51)(1,"p",52),e._uU(2,"* Please enter a valid email address"),e.qZA()())}function A(t,l){1&t&&(e.TgZ(0,"ion-text",51)(1,"p",52),e._uU(2,"* Please enter a valid phone number"),e.qZA()())}function M(t,l){1&t&&(e.TgZ(0,"ion-text",53)(1,"p",52),e._uU(2,"* Password must be of minimum 8 characters long."),e.qZA()())}function E(t,l){1&t&&(e.TgZ(0,"ion-text",51)(1,"p",52),e._uU(2,"* Please enter your name"),e.qZA()())}function O(t,l){1&t&&(e.TgZ(0,"ion-text",53)(1,"p",52),e._uU(2,"* Select Opening Time."),e.qZA()())}function Q(t,l){1&t&&(e.TgZ(0,"ion-text",53)(1,"p",52),e._uU(2,"* Select Closing Time."),e.qZA()())}function N(t,l){if(1&t&&(e.TgZ(0,"ion-select-option",54),e._uU(1),e.qZA()),2&t){const n=l.$implicit;e.Q6J("value",n.uid),e.xp6(1),e.Oqu(null==n?null:n.name)}}function Y(t,l){1&t&&(e.TgZ(0,"ion-text",53)(1,"p",52),e._uU(2,"* Select City."),e.qZA()())}function L(t,l){if(1&t&&(e.TgZ(0,"p",55),e._uU(1),e.qZA()),2&t){const n=e.oxw();e.xp6(1),e.Oqu(null==n.location?null:n.location.address)}}function F(t,l){1&t&&(e.TgZ(0,"ion-text",51)(1,"p",52),e._uU(2,"* Please enter price for two persons"),e.qZA()())}function B(t,l){1&t&&(e.TgZ(0,"ion-text",51)(1,"p",52),e._uU(2,"* Please enter Expected Delivery Time"),e.qZA()())}function j(t,l){if(1&t&&e._UZ(0,"img",56),2&t){const n=e.oxw();e.Q6J("src",n.coverImage,e.LSH)}}function K(t,l){if(1&t&&(e.TgZ(0,"p"),e._uU(1),e.qZA()),2&t){const n=e.oxw();e.xp6(1),e.hij("Categories: ",n.getArrayAsString(n.categories),"")}}function k(t,l){if(1&t&&(e.TgZ(0,"p"),e._uU(1),e.qZA()),2&t){const n=e.oxw();e.xp6(1),e.hij("Cuisines: ",n.getArrayAsString(n.cuisines),"")}}function W(t,l){if(1&t&&(e.TgZ(0,"ion-button",57),e._uU(1," Save "),e.qZA()),2&t){e.oxw();const n=e.MAs(8);e.Q6J("disabled",!n.valid)}}function z(t,l){if(1&t&&(e.TgZ(0,"div",58)(1,"ion-button",59),e._UZ(2,"ion-spinner",60),e.qZA()()),2&t){e.oxw();const n=e.MAs(8);e.xp6(1),e.Q6J("disabled",!n.valid)}}const G=[{path:"",component:(()=>{class t{constructor(n,i,d,c){this.authService=n,this.afStorage=i,this.apiService=d,this.global=c,this.isLoading=!1,this.cities=[],this.location={},this.isCuisine=!1,this.cuisines=[],this.categories=[]}ngOnInit(){this.getCities()}getCities(){var n=this;return(0,y.Z)(function*(){try{n.cities=yield n.apiService.getCities()}catch(i){console.log(i),n.global.errorToast()}})()}searchLocation(){var n=this;return(0,y.Z)(function*(){try{const i={component:C.t},d=yield n.global.createModal(i);d&&(console.log(d),n.location=d)}catch(i){console.log(i)}})()}addCategory(){console.log(this.category),""!=this.category.trim()&&(console.log(this.isCuisine),this.categories.find(i=>i==this.category)?this.global.errorToast("Category already added"):(this.categories.push(this.category),this.isCuisine&&this.cuisines.push(this.category)))}clearCategory(){this.categories=[],this.cuisines=[]}getArrayAsString(n){return n.join(", ")}preview(n){console.log(n);const i=n.target.files;if(0==i.length||null==i[0].type.match(/image\/*/))return;const c=i[0],g="restaurants/"+Date.now()+"_"+c.name,v=this.afStorage.ref(g);this.afStorage.upload(g,c).snapshotChanges().pipe((0,U.x)(()=>{v.getDownloadURL().subscribe(T=>{console.log("url: ",T),T&&(this.coverImage=T)})})).subscribe(P=>{console.log("data: ",P)})}onSubmit(n){if(n.valid){if(!this.coverImage||""==this.coverImage)return void this.global.errorToast("Please select a cover image");this.location&&this.location?.lat?this.addRestaurant(n):this.global.errorToast("Please select address for this restaurant")}}addRestaurant(n){var i=this;return(0,y.Z)(function*(){try{i.isLoading=!0,console.log(n.value);const d=yield i.authService.register(n.value,"restaurant");if(d?.id){const c=new b.Z.firestore.GeoPoint(i.location.lat,i.location.lng),g=new Z(d.id,i.coverImage?i.coverImage:"",n.value.res_name,n.value.res_name.toLowerCase(),i.cuisines,0,n.value.delivery_time,n.value.price,n.value.phone,n.value.email,!1,n.value.description,n.value.openTime,n.value.closeTime,n.value.city,i.location.address,"active",0,c),v=yield i.apiService.addRestaurant(g,d.id);console.log(v),yield i.apiService.addCategories(i.categories,d.id),i.global.successToast("Restaurant Added Successfully")}else i.global.showAlert("Restaurant Registration failed");i.isLoading=!1}catch(d){console.log(d),i.isLoading=!1;let c="Could not register the restaurant, please try again.";"auth/email-already-in-use"==d.code&&(c=d.message),i.global.showAlert(c)}})()}}return t.\u0275fac=function(n){return new(n||t)(e.Y36(s.e),e.Y36(o.Q1),e.Y36(u.s),e.Y36(p.U))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-add-restaurant"]],decls:97,vars:19,consts:[["color","primary"],["slot","start"],["defaultHref","/admin"],[1,"ion-padding"],[3,"ngSubmit"],["f1","ngForm"],["lines","none"],["color","light",1,"ion-margin-bottom"],["name","person","slot","start","color","primary"],["type","text","name","name","ngModel","","placeholder","Name","required",""],["name","ngModel"],["color","danger",4,"ngIf"],["name","mail","slot","start","color","primary"],["type","email","name","email","ngModel","","email","","placeholder","Email","required",""],["emailCtrl","ngModel"],["name","call","slot","start","color","primary"],["type","tel","name","phone","ngModel","","placeholder","Phone","required","","minlength","10","maxlength","10"],["phone","ngModel"],["name","key","slot","start","color","primary"],["type","password","name","password","ngModel","","placeholder","Password","required","","minlength","8"],["passwordCtrl","ngModel"],["color","danger","class","ion-text-center",4,"ngIf"],["type","text","name","res_name","ngModel","","placeholder","Restaurant Name","required",""],["res_name","ngModel"],["type","text","name","description","ngModel","","placeholder","Description"],["description","ngModel"],["name","openTime","ngModel","","required","","presentation","time"],["openTime","ngModel"],["name","closeTime","ngModel","","required","","presentation","time"],["closeTime","ngModel"],["name","city","ngModel","","required",""],["city","ngModel"],[3,"value",4,"ngFor","ngForOf"],[1,"ion-margin-bottom"],["class","ion-text-wrap",4,"ngIf"],["color","primary","size","small",3,"click"],["name","cash-outline","slot","start","color","primary"],["type","number","name","price","ngModel","","placeholder","Price for Two","required",""],["price","ngModel"],["name","time-outline","slot","start","color","primary"],["type","number","name","delivery_time","ngModel","","placeholder","Expected Delivery Time","required",""],["delivery_time","ngModel"],["type","file",3,"change"],[3,"src",4,"ngIf"],["name","category","placeholder","Enter New Category","type","text",3,"ngModel","ngModelChange"],["mode","md","color","success","name","isCuisine",3,"ngModel","ngModelChange"],["type","button","size","small","color","primary",3,"click"],["type","button","size","small","color","danger",3,"click"],[4,"ngIf"],["expand","block","shape","round","type","submit","color","primary",3,"disabled",4,"ngIf"],["class","ion-text-center",4,"ngIf"],["color","danger"],[1,"errorMsg"],["color","danger",1,"ion-text-center"],[3,"value"],[1,"ion-text-wrap"],[3,"src"],["expand","block","shape","round","type","submit","color","primary",3,"disabled"],[1,"ion-text-center"],["shape","round","color","primary",3,"disabled"],["name","circles"]],template:function(n,i){if(1&n){const d=e.EpF();e.TgZ(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-buttons",1),e._UZ(3,"ion-back-button",2),e.qZA(),e.TgZ(4,"ion-title"),e._uU(5,"Add Restaurant"),e.qZA()()(),e.TgZ(6,"ion-content",3)(7,"form",4,5),e.NdJ("ngSubmit",function(){e.CHM(d);const g=e.MAs(8);return e.KtG(i.onSubmit(g))}),e.TgZ(9,"ion-list",6)(10,"ion-list-header")(11,"ion-label"),e._uU(12,"Owner Details"),e.qZA()(),e.TgZ(13,"ion-item",7),e._UZ(14,"ion-icon",8)(15,"ion-input",9,10),e.qZA(),e.YNc(17,_,3,0,"ion-text",11),e.TgZ(18,"ion-item",7),e._UZ(19,"ion-icon",12)(20,"ion-input",13,14),e.qZA(),e.YNc(22,f,3,0,"ion-text",11),e.TgZ(23,"ion-item",7),e._UZ(24,"ion-icon",15)(25,"ion-input",16,17),e.qZA(),e.YNc(27,A,3,0,"ion-text",11),e.TgZ(28,"ion-item",7),e._UZ(29,"ion-icon",18)(30,"ion-input",19,20),e.qZA(),e.YNc(32,M,3,0,"ion-text",21),e.qZA(),e.TgZ(33,"ion-list",6)(34,"ion-list-header")(35,"ion-label"),e._uU(36,"Restaurant Details"),e.qZA()(),e.TgZ(37,"ion-item",7),e._UZ(38,"ion-icon",8)(39,"ion-input",22,23),e.qZA(),e.YNc(41,E,3,0,"ion-text",11),e.TgZ(42,"ion-item",7),e._UZ(43,"ion-textarea",24,25),e.qZA(),e.TgZ(45,"ion-item",7)(46,"ion-label"),e._uU(47,"Open Time"),e.qZA(),e._UZ(48,"ion-datetime",26,27),e.qZA(),e.YNc(50,O,3,0,"ion-text",21),e.TgZ(51,"ion-item",7)(52,"ion-label"),e._uU(53,"Close Time"),e.qZA(),e._UZ(54,"ion-datetime",28,29),e.qZA(),e.YNc(56,Q,3,0,"ion-text",21),e.TgZ(57,"ion-item",7)(58,"ion-label"),e._uU(59,"Select City"),e.qZA(),e.TgZ(60,"ion-select",30,31),e.YNc(62,N,2,2,"ion-select-option",32),e.qZA()(),e.YNc(63,Y,3,0,"ion-text",21),e.TgZ(64,"ion-item",33)(65,"ion-label"),e._uU(66," Address "),e.YNc(67,L,2,1,"p",34),e.qZA(),e.TgZ(68,"ion-button",35),e.NdJ("click",function(){return i.searchLocation()}),e._uU(69,"Search"),e.qZA()(),e.TgZ(70,"ion-item",7),e._UZ(71,"ion-icon",36)(72,"ion-input",37,38),e.qZA(),e.YNc(74,F,3,0,"ion-text",11),e.TgZ(75,"ion-item",7),e._UZ(76,"ion-icon",39)(77,"ion-input",40,41),e.qZA(),e.YNc(79,B,3,0,"ion-text",11),e.TgZ(80,"ion-item")(81,"h4"),e._uU(82,"Cover Image"),e.qZA(),e.TgZ(83,"input",42),e.NdJ("change",function(g){return i.preview(g)}),e.qZA(),e.TgZ(84,"p"),e.YNc(85,j,1,1,"img",43),e.qZA()(),e.TgZ(86,"ion-item")(87,"ion-input",44),e.NdJ("ngModelChange",function(g){return i.category=g}),e.qZA(),e.TgZ(88,"ion-toggle",45),e.NdJ("ngModelChange",function(g){return i.isCuisine=g}),e.qZA()(),e.TgZ(89,"ion-button",46),e.NdJ("click",function(){return i.addCategory()}),e._uU(90,"ADD"),e.qZA(),e.TgZ(91,"ion-button",47),e.NdJ("click",function(){return i.clearCategory()}),e._uU(92,"CLEAR"),e.qZA(),e.YNc(93,K,2,1,"p",48),e.YNc(94,k,2,1,"p",48),e.qZA(),e.YNc(95,W,2,1,"ion-button",49),e.YNc(96,z,3,1,"div",50),e.qZA()()}if(2&n){const d=e.MAs(16),c=e.MAs(21),g=e.MAs(26),v=e.MAs(31),I=e.MAs(40),P=e.MAs(49),T=e.MAs(55),J=e.MAs(61),S=e.MAs(73),D=e.MAs(78);e.xp6(17),e.Q6J("ngIf",!d.valid&&d.touched),e.xp6(5),e.Q6J("ngIf",!c.valid&&c.touched),e.xp6(5),e.Q6J("ngIf",!g.valid&&g.touched),e.xp6(5),e.Q6J("ngIf",!v.valid&&v.touched),e.xp6(9),e.Q6J("ngIf",!I.valid&&I.touched),e.xp6(9),e.Q6J("ngIf",!P.valid&&P.touched),e.xp6(6),e.Q6J("ngIf",!T.valid&&T.touched),e.xp6(6),e.Q6J("ngForOf",i.cities),e.xp6(1),e.Q6J("ngIf",!J.valid&&J.touched),e.xp6(4),e.Q6J("ngIf",i.location&&(null==i.location?null:i.location.lat)),e.xp6(7),e.Q6J("ngIf",!S.valid&&S.touched),e.xp6(5),e.Q6J("ngIf",!D.valid&&D.touched),e.xp6(6),e.Q6J("ngIf",i.coverImage),e.xp6(2),e.Q6J("ngModel",i.category),e.xp6(1),e.Q6J("ngModel",i.isCuisine),e.xp6(5),e.Q6J("ngIf",(null==i.categories?null:i.categories.length)>0),e.xp6(1),e.Q6J("ngIf",(null==i.cuisines?null:i.cuisines.length)>0),e.xp6(1),e.Q6J("ngIf",!i.isLoading),e.xp6(1),e.Q6J("ngIf",i.isLoading)}},dependencies:[h.sg,h.O5,m._Y,m.JJ,m.JL,m.Q7,m.wO,m.nD,m.on,m.On,m.F,a.oU,a.YG,a.Sm,a.W2,a.x4,a.Gu,a.gu,a.pK,a.Ie,a.Q$,a.q_,a.yh,a.t9,a.n0,a.PQ,a.yW,a.g2,a.wd,a.ho,a.sr,a.w,a.as,a.QI,a.j9,a.cs]}),t})()}];let H=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[x.Bz.forChild(G),x.Bz]}),t})();var X=r(5642);let $=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[h.ez,m.u5,a.Pc,H,X.K]}),t})()},7172:(w,R,r)=>{r.d(R,{D:()=>b});var h=r(5861),m=r(1135),a=r(3900),x=r(3033),y=r(2223),U=r(1228),C=r(2158);let b=(()=>{class Z{get addresses(){return this._addresses.asObservable()}get addressChange(){return this._addressChange.asObservable()}constructor(e,s){this.authService=e,this.api=s,this._addresses=new m.X([]),this._addressChange=new m.X(null)}getUid(){var e=this;return(0,h.Z)(function*(){return yield e.authService.getId()})()}getAddressRef(e){var s=this;return(0,h.Z)(function*(){return s.uid||(s.uid=yield s.getUid()),yield s.api.collection("address").doc(s.uid).collection("all",e)})()}getAddresses(e){var s=this;return(0,h.Z)(function*(){try{let o;o=e?yield s.getAddressRef(p=>p.limit(e)):yield s.getAddressRef();const u=yield o.get().pipe((0,a.w)(function(){var p=(0,h.Z)(function*(_){let f=yield _.docs.map(A=>{let M=A.data();return M.id=A.id,M});return console.log(f),f});return function(_){return p.apply(this,arguments)}}())).toPromise();return console.log("allAddress: ",u),s._addresses.next(u),u}catch(o){throw console.log(o),o}})()}addAddress(e){var s=this;return(0,h.Z)(function*(){try{const o=s._addresses.value,u=new x.k(s.uid?s.uid:yield s.getUid(),e.title,e.address,e.landmark,e.house,e.lat,e.lng);let p=Object.assign({},u);delete p.id;const _=yield(yield s.getAddressRef()).add(p);console.log("response: ",_);const f=yield _.id,A={...p,id:f};return o.push(A),s._addresses.next(o),s._addressChange.next(A),A}catch(o){throw o}})()}updateAddress(e,s){var o=this;return(0,h.Z)(function*(){try{yield(yield o.getAddressRef()).doc(e).update(s);let u=o._addresses.value;const p=u.findIndex(f=>f.id==e),_=new x.k(s.user_id,s.title,s.address,s.landmark,s.house,s.lat,s.lng,e);return u[p]=_,o._addresses.next(u),o._addressChange.next(_),_}catch(u){throw u}})()}deleteAddress(e){var s=this;return(0,h.Z)(function*(){try{yield(yield s.getAddressRef()).doc(e.id).delete();let o=s._addresses.value;return o=o.filter(u=>u.id!=e.id),s._addresses.next(o),o}catch(o){throw o}})()}changeAddress(e){this._addressChange.next(e)}checkExistAddress(e){var s=this;return(0,h.Z)(function*(){try{console.log("check exist address: ",e);let o=e;const u=yield(yield s.getAddressRef(p=>p.where("lat","==",e.lat).where("lng","==",e.lng))).get().pipe((0,a.w)(function(){var p=(0,h.Z)(function*(_){let f=yield _.docs.map(A=>{let M=A.data();return M.id=A.id,M});return console.log(f),f});return function(_){return p.apply(this,arguments)}}())).toPromise();return console.log("addresses: ",u),u?.length>0&&(o=u[0]),console.log("loc: ",o),s.changeAddress(o),o}catch(o){throw o}})()}}return Z.\u0275fac=function(e){return new(e||Z)(y.LFG(U.e),y.LFG(C.s))},Z.\u0275prov=y.Yz7({token:Z,factory:Z.\u0275fac,providedIn:"root"}),Z})()}}]);