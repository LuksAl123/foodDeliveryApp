"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[965],{965:(Y,p,s)=>{s.r(p),s.d(p,{AddMenuItemPageModule:()=>F});var c=s(4755),d=s(5030),a=s(6794),f=s(4517),u=s(5861),M=s(8746),e=s(2223),v=s(7020),A=s(2158),I=s(9097);const Z=["filePicker"];function T(o,l){if(1&o&&(e.TgZ(0,"ion-select-option",29),e._uU(1),e.qZA()),2&o){const t=l.$implicit;e.Q6J("value",t.uid),e.xp6(1),e.Oqu(null==t?null:t.name)}}function P(o,l){1&o&&(e.TgZ(0,"ion-text",30)(1,"p",31),e._uU(2,"* Select Restaurant."),e.qZA()())}function x(o,l){if(1&o&&(e.TgZ(0,"ion-select-option",29),e._uU(1),e.qZA()),2&o){const t=l.$implicit;e.Q6J("value",t.id),e.xp6(1),e.Oqu(null==t?null:t.name)}}function y(o,l){1&o&&(e.TgZ(0,"ion-text",30)(1,"p",31),e._uU(2,"* Select Category"),e.qZA()())}function b(o,l){if(1&o){const t=e.EpF();e.TgZ(0,"div")(1,"ion-item")(2,"ion-label"),e._uU(3,"Select Category"),e.qZA(),e.TgZ(4,"ion-select",32,33),e.NdJ("ngModelChange",function(i){e.CHM(t);const r=e.oxw();return e.KtG(r.category=i)}),e.YNc(6,x,2,2,"ion-select-option",9),e.qZA()(),e.YNc(7,y,3,0,"ion-text",10),e.qZA()}if(2&o){const t=e.MAs(5),n=e.oxw();e.xp6(4),e.Q6J("ngModel",n.category),e.xp6(2),e.Q6J("ngForOf",n.categories),e.xp6(1),e.Q6J("ngIf",!t.valid&&t.touched)}}function J(o,l){1&o&&(e.TgZ(0,"ion-text",34)(1,"p",31),e._uU(2,"* Please enter your name"),e.qZA()())}function C(o,l){1&o&&(e.TgZ(0,"ion-text",34)(1,"p",31),e._uU(2,"* Please enter the price"),e.qZA()())}function U(o,l){if(1&o){const t=e.EpF();e.TgZ(0,"div",35),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.changeImage())}),e._UZ(1,"ion-icon",36),e.TgZ(2,"p"),e._uU(3,"Upload Item Image here"),e.qZA()()}}function Q(o,l){if(1&o){const t=e.EpF();e.TgZ(0,"div",37),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.changeImage())}),e._UZ(1,"ion-img",38),e.qZA()}if(2&o){const t=e.oxw();e.xp6(1),e.Q6J("src",t.image)}}function q(o,l){if(1&o&&(e.TgZ(0,"ion-button",39),e._uU(1," Save "),e.qZA()),2&o){e.oxw();const t=e.MAs(8);e.Q6J("disabled",!t.valid)}}function S(o,l){if(1&o&&(e.TgZ(0,"div",40)(1,"ion-button",41),e._UZ(2,"ion-spinner",42),e.qZA()()),2&o){e.oxw();const t=e.MAs(8);e.xp6(1),e.Q6J("disabled",!t.valid)}}const R=[{path:"",component:(()=>{class o{constructor(t,n,i){this.global=t,this.apiService=n,this.afStorage=i,this.restaurants=[],this.categories=[],this.isLoading=!1,this.veg=!0,this.status=!0}ngOnInit(){this.getRestaurants()}getRestaurants(){var t=this;return(0,u.Z)(function*(){try{t.global.showLoader(),t.restaurants=yield t.apiService.getRestaurants(),t.global.hideLoader()}catch(n){console.log(n),t.global.hideLoader(),t.global.errorToast()}})()}changeRestaurant(t){var n=this;return(0,u.Z)(function*(){try{console.log(t),n.global.showLoader(),n.categories=yield n.apiService.getRestaurantCategories(t.detail.value),n.category="",n.global.hideLoader()}catch(i){console.log(i),n.global.hideLoader(),n.global.errorToast()}})()}onSubmit(t){var n=this;return(0,u.Z)(function*(){if(t.valid&&n.image)try{n.isLoading=!0;const i=yield n.uploadImage(n.imageFile);if(console.log(i),!i)return n.isLoading=!1,void n.global.errorToast("Image not uploaded, please try again");const r={cover:i,veg:n.veg,status:n.status,...t.value};console.log("data: ",r),yield n.apiService.addMenuItem(r),n.isLoading=!1,n.global.successToast("Menu Item Added Successfully")}catch(i){console.log(i),n.isLoading=!1,n.global.errorToast()}})()}changeImage(){console.log(this.filePickerRef),this.filePickerRef&&this.filePickerRef.nativeElement?this.filePickerRef.nativeElement.click():console.error("filePickerRef is not defined")}onFileChosen(t){const n=t.target.files[0];if(!n)return;console.log("file: ",n),this.imageFile=n;const i=new FileReader;console.log(i),i.onload=()=>{const r=i.result.toString();this.image=r,console.log("image: ",this.image)},i.readAsDataURL(n)}uploadImage(t){return new Promise((n,i)=>{if(null==t.type.match(/image\/*/))return;const g=t,_="menu/"+Date.now()+"_"+g.name,L=this.afStorage.ref(_);this.afStorage.upload(_,g).snapshotChanges().pipe((0,M.x)(()=>{L.getDownloadURL().subscribe(m=>{console.log("url: ",m),m&&n(m)})})).subscribe(h=>{console.log(h)})})}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(v.U),e.Y36(A.s),e.Y36(I.Q1))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-add-menu-item"]],viewQuery:function(t,n){if(1&t&&e.Gf(Z,5),2&t){let i;e.iGM(i=e.CRH())&&(n.filePickerRef=i.first)}},decls:45,vars:11,consts:[["color","primary"],["slot","start"],["defaultHref","/admin"],[1,"ion-padding"],[3,"ngSubmit"],["f1","ngForm"],["lines","none"],["interface","popover","name","restaurant_id","ngModel","","required","",3,"ionChange"],["restaurant_id","ngModel"],[3,"value",4,"ngFor","ngForOf"],["color","danger","class","ion-text-center",4,"ngIf"],[4,"ngIf"],["name","person","slot","start","color","primary"],["type","text","name","name","ngModel","","placeholder","Name","required",""],["name","ngModel"],["color","danger",4,"ngIf"],["type","text","name","description","ngModel","","placeholder","Description"],["description","ngModel"],["name","cash-outline","slot","start","color","primary"],["type","number","name","price","ngModel","","placeholder","Price","required",""],["price","ngModel"],["slot","end","name","veg",3,"ngModel","ngModelChange"],["slot","end","name","status",3,"ngModel","ngModelChange"],["class","itemImage",3,"click",4,"ngIf"],["type","file","accept","image/jpeg",3,"change"],["filePicker",""],["class","itemImage imageDiv",3,"click",4,"ngIf"],["expand","block","shape","round","type","submit","color","primary",3,"disabled",4,"ngIf"],["class","ion-text-center",4,"ngIf"],[3,"value"],["color","danger",1,"ion-text-center"],[1,"errorMsg"],["interface","popover","name","category_id","required","",3,"ngModel","ngModelChange"],["category_id","ngModel"],["color","danger"],[1,"itemImage",3,"click"],["name","cloud-upload-outline","color","primary"],[1,"itemImage","imageDiv",3,"click"],[3,"src"],["expand","block","shape","round","type","submit","color","primary",3,"disabled"],[1,"ion-text-center"],["shape","round","color","primary",3,"disabled"],["name","circles"]],template:function(t,n){if(1&t){const i=e.EpF();e.TgZ(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-buttons",1),e._UZ(3,"ion-back-button",2),e.qZA(),e.TgZ(4,"ion-title"),e._uU(5,"Add Menu Item"),e.qZA()()(),e.TgZ(6,"ion-content",3)(7,"form",4,5),e.NdJ("ngSubmit",function(){e.CHM(i);const g=e.MAs(8);return e.KtG(n.onSubmit(g))}),e.TgZ(9,"ion-list",6)(10,"ion-item")(11,"ion-label"),e._uU(12,"Select Restaurant"),e.qZA(),e.TgZ(13,"ion-select",7,8),e.NdJ("ionChange",function(g){return n.changeRestaurant(g)}),e.YNc(15,T,2,2,"ion-select-option",9),e.qZA()(),e.YNc(16,P,3,0,"ion-text",10),e.YNc(17,b,8,3,"div",11),e.TgZ(18,"ion-item"),e._UZ(19,"ion-icon",12)(20,"ion-input",13,14),e.qZA(),e.YNc(22,J,3,0,"ion-text",15),e.TgZ(23,"ion-item"),e._UZ(24,"ion-textarea",16,17),e.qZA(),e.TgZ(26,"ion-item"),e._UZ(27,"ion-icon",18)(28,"ion-input",19,20),e.qZA(),e.YNc(30,C,3,0,"ion-text",15),e.TgZ(31,"ion-item")(32,"ion-label"),e._uU(33,"Veg"),e.qZA(),e.TgZ(34,"ion-toggle",21),e.NdJ("ngModelChange",function(g){return n.veg=g}),e.qZA()(),e.TgZ(35,"ion-item")(36,"ion-label"),e._uU(37,"Status"),e.qZA(),e.TgZ(38,"ion-toggle",22),e.NdJ("ngModelChange",function(g){return n.status=g}),e.qZA()(),e.YNc(39,U,4,0,"div",23),e.TgZ(40,"input",24,25),e.NdJ("change",function(g){return n.onFileChosen(g)}),e.qZA(),e.YNc(42,Q,2,1,"div",26),e.qZA(),e.YNc(43,q,2,1,"ion-button",27),e.YNc(44,S,3,1,"div",28),e.qZA()()}if(2&t){const i=e.MAs(14),r=e.MAs(21),g=e.MAs(29);e.xp6(15),e.Q6J("ngForOf",n.restaurants),e.xp6(1),e.Q6J("ngIf",!i.valid&&i.touched),e.xp6(1),e.Q6J("ngIf",(null==n.categories?null:n.categories.length)>0),e.xp6(5),e.Q6J("ngIf",!r.valid&&r.touched),e.xp6(8),e.Q6J("ngIf",!g.valid&&g.touched),e.xp6(4),e.Q6J("ngModel",n.veg),e.xp6(4),e.Q6J("ngModel",n.status),e.xp6(1),e.Q6J("ngIf",!n.image||""==n.image),e.xp6(3),e.Q6J("ngIf",n.image&&""!=n.image),e.xp6(1),e.Q6J("ngIf",!n.isLoading),e.xp6(1),e.Q6J("ngIf",n.isLoading)}},dependencies:[c.sg,c.O5,d._Y,d.JJ,d.JL,d.Q7,d.On,d.F,a.oU,a.YG,a.Sm,a.W2,a.Gu,a.gu,a.Xz,a.pK,a.Ie,a.Q$,a.q_,a.t9,a.n0,a.PQ,a.yW,a.g2,a.wd,a.ho,a.sr,a.w,a.as,a.QI,a.j9,a.cs],styles:["ion-item[_ngcontent-%COMP%]{border:1px solid var(--ion-color-medium);border-radius:5px;margin-top:1vh}.itemImage[_ngcontent-%COMP%]{border:1px solid var(--ion-color-medium);border-radius:5px;text-align:center;margin-top:1vh;padding:5vh}.imageDiv[_ngcontent-%COMP%]{height:200px}ion-img[_ngcontent-%COMP%]{height:100%;width:100%;object-fit:cover}input[type=file][_ngcontent-%COMP%]{display:none}"]}),o})()}];let N=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[f.Bz.forChild(R),f.Bz]}),o})(),F=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[c.ez,d.u5,a.Pc,N]}),o})()}}]);