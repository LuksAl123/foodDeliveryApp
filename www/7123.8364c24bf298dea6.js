"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[7123],{7123:(y,L,i)=>{i.d(L,{t:()=>D});var u=i(5861),o=i(2223),E=i(7020),T=i(9514),h=i(2875),p=i(7172),b=i(4755),s=i(6794);function x(t,r){1&t&&(o.TgZ(0,"ion-title",10)(1,"ion-label"),o._uU(2,"Choose a delivery address"),o.qZA()())}function _(t,r){if(1&t){const e=o.EpF();o.TgZ(0,"ion-buttons",11)(1,"ion-button",12),o.NdJ("click",function(){o.CHM(e);const a=o.oxw(2);return o.KtG(a.dismiss())}),o._UZ(2,"ion-icon",13),o.qZA()()}}function c(t,r){if(1&t){const e=o.EpF();o.TgZ(0,"ion-searchbar",14,15),o.NdJ("ionChange",function(a){o.CHM(e);const d=o.oxw(2);return o.KtG(d.onSearchChange(a))}),o.qZA()}}function m(t,r){if(1&t){const e=o.EpF();o.TgZ(0,"ion-buttons",16)(1,"ion-button",17),o.NdJ("click",function(){o.CHM(e);const a=o.oxw(2);return o.KtG(a.dismiss())}),o._uU(2,"Cancel"),o.qZA()()}}function f(t,r){if(1&t&&(o.TgZ(0,"ion-header",4)(1,"ion-toolbar",5),o.YNc(2,x,3,0,"ion-title",6),o.YNc(3,_,3,0,"ion-buttons",7),o.YNc(4,c,2,0,"ion-searchbar",8),o.YNc(5,m,3,0,"ion-buttons",9),o.qZA()()),2&t){const e=o.oxw();o.xp6(2),o.Q6J("ngIf","cart"==e.from),o.xp6(1),o.Q6J("ngIf",e.from&&"select-place"==e.from),o.xp6(1),o.Q6J("ngIf",!e.from||"select-place"==e.from),o.xp6(1),o.Q6J("ngIf",!e.from)}}function l(t,r){if(1&t){const e=o.EpF();o.TgZ(0,"ion-item",18),o.NdJ("click",function(){o.CHM(e);const a=o.oxw();return o.KtG(a.getCurrentPosition())}),o._UZ(1,"ion-icon",19),o.TgZ(2,"ion-label"),o._uU(3," Current location "),o.TgZ(4,"p"),o._uU(5,"Using GPS"),o.qZA()()()}}function g(t,r){1&t&&(o.TgZ(0,"ion-list-header")(1,"ion-text",22)(2,"h5"),o._uU(3,"SAVED ADDRESS"),o.qZA()()())}function C(t,r){if(1&t){const e=o.EpF();o.TgZ(0,"ion-item")(1,"ion-label"),o._uU(2,"Select Delivery Address"),o.qZA(),o.TgZ(3,"ion-button",23),o.NdJ("click",function(){o.CHM(e);const a=o.oxw(2);return o.KtG(a.dismiss("select"))}),o._uU(4,"VIEW ALL"),o.qZA()()}}function v(t,r){if(1&t){const e=o.EpF();o.TgZ(0,"ion-item",18),o.NdJ("click",function(){const d=o.CHM(e).$implicit,S=o.oxw(2);return o.KtG(S.selectSavedPlace(d))}),o._UZ(1,"ion-icon",24),o.TgZ(2,"ion-label"),o._uU(3),o.TgZ(4,"p"),o._uU(5),o.qZA()()()}if(2&t){const e=r.$implicit;o.xp6(3),o.hij(" ",null==e?null:e.title," "),o.xp6(2),o.Oqu(null==e?null:e.address)}}function P(t,r){if(1&t){const e=o.EpF();o.TgZ(0,"ion-item",25),o.NdJ("click",function(){o.CHM(e);const a=o.oxw(2);return o.KtG(a.dismiss("select"))}),o._UZ(1,"ion-icon",26),o.TgZ(2,"ion-text")(3,"h5"),o._uU(4,"Enter Location Manually"),o.qZA()()()}}function M(t,r){if(1&t){const e=o.EpF();o.TgZ(0,"ion-item",25),o.NdJ("click",function(){o.CHM(e);const a=o.oxw(2);return o.KtG(a.dismiss("add"))}),o._UZ(1,"ion-icon",27),o.TgZ(2,"ion-text",28)(3,"h5"),o._uU(4,"ADD NEW ADDRESS"),o.qZA()()()}}function Z(t,r){if(1&t&&(o.TgZ(0,"ion-list"),o.YNc(1,g,4,0,"ion-list-header",3),o.YNc(2,C,5,0,"ion-item",3),o.YNc(3,v,6,2,"ion-item",20),o.YNc(4,P,5,0,"ion-item",21),o.YNc(5,M,5,0,"ion-item",21),o.qZA()),2&t){const e=o.oxw();o.xp6(1),o.Q6J("ngIf","select-place"==e.from),o.xp6(1),o.Q6J("ngIf","home"==e.from),o.xp6(1),o.Q6J("ngForOf",e.savedPlaces),o.xp6(1),o.Q6J("ngIf","home"==e.from),o.xp6(1),o.Q6J("ngIf","cart"==e.from||"select-place"==e.from)}}function A(t,r){if(1&t){const e=o.EpF();o.TgZ(0,"ion-item",18),o.NdJ("click",function(){const d=o.CHM(e).$implicit,S=o.oxw(2);return o.KtG(S.choosePlace(d))}),o._UZ(1,"ion-icon",29),o.TgZ(2,"ion-label"),o._uU(3),o.TgZ(4,"p"),o._uU(5),o.qZA()()()}if(2&t){const e=r.$implicit;o.xp6(3),o.hij(" ",null==e?null:e.title," "),o.xp6(2),o.Oqu(null==e?null:e.address)}}function I(t,r){if(1&t&&(o.TgZ(0,"ion-list")(1,"ion-list-header")(2,"h5"),o._uU(3,"SEARCH RESULTS"),o.qZA()(),o.YNc(4,A,6,2,"ion-item",20),o.qZA()),2&t){const e=o.oxw();o.xp6(4),o.Q6J("ngForOf",e.places)}}let D=(()=>{class t{constructor(e,n,a,d){this.global=e,this.maps=n,this.locationService=a,this.addressService=d,this.places=[],this.savedPlaces=[]}ngOnInit(){this.placeSub=this.maps.places.subscribe(e=>{this.places=e}),this.from&&this.getSavedPlaces()}getSavedPlaces(){var e=this;return(0,u.Z)(function*(){e.global.showLoader(),e.addressSub=e.addressService.addresses.subscribe(n=>{e.savedPlaces=n}),"home"==e.from?yield e.addressService.getAddresses(2):yield e.addressService.getAddresses(),e.global.hideLoader()})()}selectSavedPlace(e){this.dismiss(e)}onSearchChange(e){var n=this;return(0,u.Z)(function*(){console.log(e),n.global.showLoader(),n.query=e.detail.value,n.query.length>0&&(yield n.maps.getPlaces(n.query)),n.global.hideLoader()})()}dismiss(e){this.global.modalDismiss(e)}choosePlace(e){var n=this;return(0,u.Z)(function*(){if(n.global.showLoader(),console.log(e),n.from){const a=yield n.savedPlaces.find(d=>d.lat==e.lat&&d.lng==e.lng);a?.lat&&(e=a)}n.global.hideLoader(),n.dismiss(e)})()}getCurrentPosition(){var e=this;return(0,u.Z)(function*(){try{e.global.showLoader();const n=yield e.locationService.getCurrentLocation(),{latitude:a,longitude:d}=n.coords,S=yield e.maps.getAddress(a,d);console.log(S);const O={title:S.address_components[0].short_name,address:S.formatted_address,lat:a,lng:d};e.global.hideLoader(),e.dismiss(O)}catch(n){console.log(n),e.global.hideLoader(),e.global.errorToast("Check whether GPS is enabled & the App has its permissions",5e3)}})()}ngOnDestroy(){this.placeSub&&this.placeSub.unsubscribe(),this.addressSub&&this.addressSub.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(o.Y36(E.U),o.Y36(T.t),o.Y36(h.a),o.Y36(p.D))},t.\u0275cmp=o.Xpm({type:t,selectors:[["app-search-location"]],inputs:{from:"from"},decls:5,vars:4,consts:[["class","ion-no-border",4,"ngIf"],[1,"ion-padding"],[3,"click",4,"ngIf"],[4,"ngIf"],[1,"ion-no-border"],["color","light"],["mode","md",4,"ngIf"],["slot","start",4,"ngIf"],["slot","start","animated","true","debounce","800","placeholder","Search for area, street...",3,"ionChange",4,"ngIf"],["slot","end",4,"ngIf"],["mode","md"],["slot","start"],["fill","clear",3,"click"],["name","arrow-back-outline","color","dark","slot","icon-only"],["slot","start","animated","true","debounce","800","placeholder","Search for area, street...",3,"ionChange"],["searchInput",""],["slot","end"],["fill","clear","color","dark",3,"click"],[3,"click"],["slot","start","name","locate-outline"],[3,"click",4,"ngFor","ngForOf"],["lines","none",3,"click",4,"ngIf"],["color","secondary"],["color","primary","fill","clear","size","small","slot","end",3,"click"],["name","location-outline","slot","start"],["lines","none",3,"click"],["name","search-outline","color","primary","slot","start"],["slot","start","name","add","color","primary"],["color","primary"],["slot","start","name","location-outline"]],template:function(e,n){1&e&&(o.YNc(0,f,6,4,"ion-header",0),o.TgZ(1,"ion-content",1),o.YNc(2,l,6,0,"ion-item",2),o.YNc(3,Z,6,5,"ion-list",3),o.YNc(4,I,5,1,"ion-list",3),o.qZA()),2&e&&(o.Q6J("ngIf",!n.from||"home"!=n.from),o.xp6(2),o.Q6J("ngIf",!n.from||"cart"!=n.from),o.xp6(1),o.Q6J("ngIf",n.from&&(!n.query||0==(null==n.query?null:n.query.length))),o.xp6(1),o.Q6J("ngIf",(null==n.places?null:n.places.length)>0&&(null==n.query?null:n.query.length)>0))},dependencies:[b.sg,b.O5,s.YG,s.Sm,s.W2,s.Gu,s.gu,s.Ie,s.Q$,s.q_,s.yh,s.VI,s.yW,s.wd,s.sr,s.j9],styles:[".ios[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]{padding-top:3vh}"]}),t})()},9514:(y,L,i)=>{i.d(L,{t:()=>b});var u=i(5861),o=i(2340),E=i(4004),T=i(1135),h=i(2223),p=i(3144);let b=(()=>{class s{get places(){return this._places.asObservable()}get markerChange(){return this._markerChange.asObservable()}constructor(_,c){this.http=_,this.zone=c,this._places=new T.X([]),this._markerChange=new T.X({})}loadGoogleMaps(){const _=window,c=_.google;return c&&c.maps?Promise.resolve(c.maps):new Promise((m,f)=>{const l=document.createElement("script");l.src="https://maps.googleapis.com/maps/api/js?key="+o.N.googleMapsApiKey+"&libraries=places",l.async=!0,l.defer=!0,document.body.appendChild(l),l.onload=()=>{const g=_.google;g&&g.maps?m(g.maps):f("Google Map SDK is not Available")}})}getAddress(_,c){return new Promise((m,f)=>{this.http.get(`https://maps.googleapis.com/maps/api/geocode/json?latlng=${_},${c}&key=${o.N.googleMapsApiKey}`).pipe((0,E.U)(l=>{if(!l||!l.results||0===l.results.length)throw null;return l.results[0]})).subscribe(l=>{m(l)},l=>{f(l)})})}getPlaces(_){var c=this;return(0,u.Z)(function*(){try{c.googleMaps||(c.googleMaps=yield c.loadGoogleMaps());let m=c.googleMaps;console.log("maps: ",c.googleMaps),(new m.places.AutocompleteService).getPlacePredictions({input:_,componentRestrictions:{country:"IN"}},l=>{let g=[];c.zone.run(()=>{null!=l&&(l.forEach(function(){var C=(0,u.Z)(function*(v){console.log("prediction: ",v);let P=yield c.geoCode(v.description,m);const M={title:v.structured_formatting.main_text,address:v.description,lat:P.lat,lng:P.lng};console.log("places: ",M),g.push(M)});return function(v){return C.apply(this,arguments)}}()),c._places.next(g))})})}catch(m){console.log(m)}})()}geoCode(_,c){let m={lat:"",lng:""};return new Promise((f,l)=>{(new c.Geocoder).geocode({address:_},C=>{console.log("results: ",C),m.lat=C[0].geometry.location.lat(),m.lng=C[0].geometry.location.lng(),f(m)})})}changeMarkerInMap(_){this._markerChange.next(_)}}return s.\u0275fac=function(_){return new(_||s)(h.LFG(p.eN),h.LFG(h.R0b))},s.\u0275prov=h.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})()},2875:(y,L,i)=>{i.d(L,{a:()=>h});var u=i(5861),o=i(7423);const E=(0,o.fo)("Geolocation",{web:()=>i.e(4561).then(i.bind(i,4561)).then(p=>new p.GeolocationWeb)});var T=i(2223);let h=(()=>{class p{constructor(){}getCurrentLocation(){return(0,u.Z)(function*(){return o.dV.isPluginAvailable("Geolocation")?yield E.getCurrentPosition({maximumAge:3e3,timeout:1e4,enableHighAccuracy:!1}):null})()}}return p.\u0275fac=function(s){return new(s||p)},p.\u0275prov=T.Yz7({token:p,factory:p.\u0275fac,providedIn:"root"}),p})()}}]);